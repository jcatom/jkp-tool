<!--index.wxml-->
<view class="container bg-gray">
  <view class="container">

    <!-- Header -->
    <view class="header-wrap">
      <!--用户信息-->
      <view class="userinfo" open-type="getUserInfo" bindgetuserinfo="getUserInfo">
        <image class="avatar" src="{{userInfo.avatarUrl || '/img/index/wx.png'}}" background-size="cover"></image>
        <!-- 需要使用 button 来授权登录 -->
        <button wx:if="{{canIUse}}" open-type="getUserInfo" bindgetuserinfo="getUserInfoAndLogin"
          class="nickname">{{ userInfo.nickName || '点击登录' }}</button>
        <view wx:else>请升级微信版本</view>
      </view>

      <!--游戏记录-->
      <view class="game-record" bindtap="toRecordList">
        <text>游戏记录></text>
      </view>
    </view>

    <!-- tab切换 -->
    <view class="swiper-tab">
      <view class="swiper-tab-list {{currentTab==0 ? 'on' : ''}}" data-current="0" bindtap="swichNav"><text
          data-current="0" bindtap="swichNav">游戏1</text></view>
      <view class="swiper-tab-list {{currentTab==1 ? 'on' : ''}}" data-current="1" bindtap="swichNav"><text
          data-current="1" bindtap="swichNav">游戏2</text></view>
      <view class="swiper-tab-list {{currentTab==2 ? 'on' : ''}}" data-current="2" bindtap="swichNav"><text
          data-current="2" bindtap="swichNav">游戏3</text></view>
    </view>

    <!-- 自定义输入框 -->
    <view class="input-box-wrap">
      <scroll-view class='input-box' scroll-y="{{true}}" scroll-into-view="{{textScrollId}}" catchtap='showKeyboard'
        bindlongpress="showPasteTip">
        <!-- 所有行 -->
        <view wx:for="{{textValueGroup}}" wx:for-item="textGroup" data-source="{{textGroup}}"
          catchtap="handleTextGroupTap">
          <!-- 每一行 -->
          <block wx:for="{{textGroup}}" wx:for-index="valueIndex">
            <view class="cursor-wrap" style="display:inline-block" catchtap="onTextTap" data-index="{{item.index}}">
              <!-- 光标 -->
              <view class="{{cursorIndex === item.index ? 'cursor cursor-animate' : 'cursor'}}"
                id="{{cursorIndex === item.index ? 'active-cursor' : 'cursor'}}" data-index="{{item.index}}"></view>
              <!-- 粘贴提示 -->
              <view wx:if="{{cursorIndex === item.index && pasteTipVisible}}" class="pasteTip" bindtap="pasteText">
                <text class="arrow"></text>
                <text>粘贴</text>
              </view>
              <!-- 文字 -->
              <text data-index="{{item.index}}" style="vertcal-align:middle">{{item.val}}</text>
            </view>
          </block>
        </view>

      </scroll-view>
    </view>
    <view class="error-msg c-red">{{errorMsg}}</view>

    <!-- 游戏一描述 -->
    <view class="desc" style="display:{{currentTab==0 ? '' : 'none'}}">
      <text class="title">SSQ格式说明：</text>
      <text>1.号码与号码使用","或空格隔开</text>
      <text>2.前区与后区使用"|"或"-"隔开</text>
      <text bindtap="toggleDTDialog">3.胆和拖用"#"隔开<text class="question-icon">?</text></text>
      <text>4.号码后用"+"连接倍数</text>
      <text>5.多组号码使用换行</text>
      <text class="title">示例：</text>
      <view wx:for="{{example[currentTab]}}" wx:key="index" class="example">
        <view>
          <text>{{item.value}}</text>
          <text>（{{item.remark}}）</text>
        </view>
        <text bindtap="copyText" data-text="{{item.value}}">使用该组号码</text>
      </view>
    </view>
    <!-- 游戏二描述 -->
    <view class="desc" style="display:{{currentTab==1 ? '' : 'none'}}">
      <text class="title">QLC格式说明：</text>
      <text>1.号码与号码之间使用","或"-"或空格隔开</text>
      <text bindtap="toggleDTDialog">2.胆和拖用"#"隔开<text class="question-icon">?</text></text>
      <text>3.号码后用"+"连接倍数</text>
      <text>4.多组号码使用换行</text>
      <text class="title">示例：</text>
      <view wx:for="{{example[currentTab]}}" wx:key="index" class="example">
        <view>
          <text>{{item.value}}</text>
          <text>（{{item.remark}}）</text>
        </view>
        <text bindtap="copyText" data-text="{{item.value}}">使用该组号码</text>
      </view>
    </view>
    <!-- 游戏三描述 -->
    <view class="desc" style="display:{{currentTab==2 ? '' : 'none'}}">
      <text class="title">SD格式说明：</text>
      <text>1.直选号码与号码之间使用"-"或"|"或空格隔开</text>
      <text>2.组选号码与号码之间使用","隔开</text>
      <text>3.号码后用"+"连接倍数</text>
      <text>4.多组号码使用换行</text>
      <text class="title">示例：</text>
      <view wx:for="{{example[currentTab]}}" wx:key="index" class="example">
        <view>
          <text>{{item.value}}</text>
          <text>（{{item.remark}}）</text>
        </view>
        <text bindtap="copyText" data-text="{{item.value}}">使用该组号码</text>
      </view>
    </view>

    <view class="createQRbtn" bindtap="confirmSubmit" style="background:{{isLogin?'#FF494B':'#fca1a2'}}">
      生成二维码
    </view>


  </view>



  <!-- 自定义键盘 -->
  <wux-popup position="bottom" visible="{{ keyBoardVisible }}" bind:close="closeKeyboard" mask="{{false}}"
    maskClosable="{{false}}">
    <view class="keyboard">
      <!-- 顶部 -->
      <view class="top-row">
        <view class="inputClear" bindtap="_clearNumber">清空</view>
        <view class="inputConfirm" bindtap="_confirmNumber">完成</view>
      </view>

      <view class="keyboard-main">
        <view class="left-part">
          <!-- 123 -->
          <view class="keyboard-line">
            <view wx:for="{{'123'}}" wx:key="index" wx:for-item="number" data-number="{{number}}"
              bindtap="_inputNumber">
              <view class="input-btn" hover-class='active' hover-stay-time='100'>{{number}}</view>
            </view>
          </view>

          <!-- 456 -->
          <view class="keyboard-line">
            <view wx:for="{{'456'}}" wx:key="index" wx:for-item="number" data-number="{{number}}"
              bindtap="_inputNumber">
              <view class="input-btn" hover-class='active' hover-stay-time='100'>{{number}}</view>
            </view>
          </view>

          <!-- 789 -->
          <view class="keyboard-line">
            <view wx:for="{{'789'}}" wx:key="index" wx:for-item="number" data-number="{{number}}"
              bindtap="_inputNumber">
              <view class="input-btn" hover-class='active' hover-stay-time='100'>{{number}}</view>
            </view>
          </view>

          <!-- +0- -->
          <view class="keyboard-line">
            <view data-number="+" bindtap="_inputNumber">
              <view class="input-btn" hover-class='active' hover-stay-time='100'>+</view>
            </view>
            <view data-number="0" bindtap="_inputNumber">
              <view class="input-btn" hover-class='active' hover-stay-time='100'>0</view>
            </view>
            <view data-number="-" bindtap="_inputNumber">
              <view class="input-btn" hover-class='active' hover-stay-time='100'>-</view>
            </view>
          </view>
        </view>

        <view class="right-part">
          <view class="keyboard-line">
            <view data-number="," bindtap="_inputNumber">
              <view class="input-btn" hover-class='active' hover-stay-time='100'>,</view>
            </view>
          </view>
          <view class="keyboard-line">
            <view data-number="|" bindtap="_inputNumber">
              <view class="input-btn" hover-class='active' hover-stay-time='100'>|</view>
            </view>
          </view>
          <view class="keyboard-line">
            <view data-number="#" bindtap="_inputNumber">
              <view class="input-btn" hover-class='active' hover-stay-time='100'>#</view>
            </view>
          </view>

          <view class="keyboard-line">
            <view bindtap="_delNumber">
              <view class="input-btn" hover-class='active' hover-stay-time='100'>⇦</view>
            </view>
          </view>
          <view class="keyboard-line">
            <view bindtap="_br">
              <view class="input-btn" hover-class='active' hover-stay-time='100'>↵</view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </wux-popup>

  <!-- 生成二维码确认弹框 -->
  <view class="zan-dialog {{ showDialog ? 'zan-dialog--show' : '' }}">
    <!-- 如果想点击弹窗外不隐藏，取消bindtap点击事件即可 -->
    <view class="zan-dialog__mask" bindtap="toggleDialog" />
    <view class="zan-dialog__container">
      <view class="title">号码确认</view>
      <view class="content">
        <view>您输入的号码为：</view>
        <view class="number">
          <text wx:for="{{showDialogTextArr}}">
            {{item}}
          </text>
        </view>
        <view>是否确认？</view>
      </view>
      <view class="footer">
        <view class="btn" bindtap="toggleDialog">取消</view>
        <view class="btn c-red" bindtap="createQrCode">确定</view>
      </view>
    </view>
  </view>

  <!-- 胆拖说明 -->
  <view class="zan-dialog {{ showDTDialog ? 'zan-dialog--show' : '' }}">
    <!-- 如果想点击弹窗外不隐藏，取消bindtap点击事件即可 -->
    <view class="zan-dialog__mask" />
    <view class="zan-dialog__container">
      <view class="title">胆拖说明</view>
      <view class="content">
        <text>“胆”是指每一注组合中都包含的号码，\n</text>
        <text>“拖”是指所选号码中除“胆码”以外的其它号码。\n</text>
        <text>“胆”+“拖”数量之和必须多于单式选号的号码个数；\n</text>
        <text>“胆”和“拖”不能重复；“胆”的个数要少于单式选号的个数。</text>
      </view>
      <view class="footer">
        <view class="btn c-red" bindtap="toggleDTDialog">确定</view>
      </view>
    </view>
  </view>

  <!-- 自动登录确认授权用户信息 -->
  <view class="zan-dialog {{ showLoginDialog ? 'zan-dialog--show' : '' }}">
    <!-- 如果想点击弹窗外不隐藏，取消bindtap点击事件即可 -->
    <view class="zan-dialog__mask" />
    <view class="zan-dialog__container" style="bottom:500rpx">
      <view class="title">登录授权</view>
      <view class="content">
        <text>小游戏申请您的昵称及头像权限\n</text>
      </view>
      <view class="footer">
        <navigator class="btn" open-type="exit" target="miniProgram" bindtap="hideLoginDialog">退出</navigator>
        <button class="btn c-green" open-type="getUserInfo" bindgetuserinfo="getUserInfoAndLogin" bindtap="hideLoginDialog">确定</button>
      </view>
    </view>
  </view>

</view>